{"nodeList": [{"identifier": "logs_total_users", "definition": "result = len(logs_users)", "title": "Total users", "nodeClass": "report", "moduleId": "logs_overview", "x": 40, "y": 70, "z": 1, "w": "180", "h": "40", "description": null, "units": null, "color": "#d5a6bd", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": null, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}, {"identifier": "logs_total_calls", "definition": "result = 0\ntry:\n    result = logs_user_calls_by_day.sum().values.item()\nexcept:\n    pass", "title": "Total calls", "nodeClass": "report", "moduleId": "logs_overview", "x": 460, "y": 130, "z": 1, "w": "180", "h": "40", "description": null, "units": null, "color": "#d5a6bd", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": null, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}, {"identifier": "logs_total_sessions", "definition": "result = len(logs_of_current_company.session_key.unique()) if logs_of_current_company is not None else 0", "title": "Total sessions", "nodeClass": "report", "moduleId": "logs_overview", "x": 250, "y": 190, "z": 1, "w": "180", "h": "40", "description": null, "units": null, "color": "#d5a6bd", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": null, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}, {"identifier": "logs_user_calls_by_day", "definition": "result = None\nif logs_of_current_company is not None:\n    df = logs_of_current_company.groupby([pd.Grouper(key='date', freq='1d'), 'user', 'session_key', 'app_uri']).agg({'calls': np.sum})\n    \n    df = df.reset_index()\n    df['date'] = df['date'].astype('str').str[:10]\n\n    result = df.set_index(['date', 'user', 'session_key', 'app_uri'])", "title": "User calls by day", "nodeClass": "variable", "moduleId": "logs_overview", "x": 250, "y": 130, "z": 1, "w": "180", "h": "40", "description": "", "units": null, "color": "#d5a6bd", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": null, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}, {"identifier": "logs_average_session_time", "definition": "result = 0\nif logs_of_current_company is not None:\n    df_duration = logs_of_current_company[['session_key', 'date', 'instance_created_at']]\n    if len(df_duration) > 0:\n        df_duration['duration'] = df_duration['date'].sub(df_duration['instance_created_at'], axis=0).astype('timedelta64[m]')\n        df = df_duration.groupby(['session_key']).agg({'duration': 'max'})\n    \n        result = (df.sum() / len(df)).values.item(0)", "title": "Average session time", "nodeClass": "report", "moduleId": "logs_overview", "x": 250, "y": 250, "z": 1, "w": "180", "h": "40", "description": null, "units": "minutes", "color": "#d5a6bd", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": null, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}, {"identifier": "logs_top_15_active_users", "definition": "# Add session duration\nresult = pd.DataFrame()\nif logs_of_current_company is not None:\n    df = logs_of_current_company[['user', 'instance_created_at', 'session_key', 'date']]\n    df['duration'] = df['date'].sub(df['instance_created_at'], axis=0).astype('timedelta64[m]')\n    df_duration = df.groupby(['user', 'session_key'], as_index=False).agg({'duration': 'max'})\n    df_duration = df_duration.groupby('user', as_index=False).sum()\n    \n    df_base = logs_of_current_company.merge(df_duration, on='user')\n    df = df_base.groupby('user', as_index=False).agg(\n        {'calls': np.sum, 'session_key': 'nunique', 'app_uri': 'nunique', 'duration':'mean'})\n    \n    df = df.sort_values('calls', ascending=False)[:15]\n    \n    df.rename(columns={\n        'session_key': 'sessions',\n        'app_uri': 'apps',\n        'duration': 'total time (min)'\n    }, inplace=True)\n    \n    df['apps'] = np.where(df['apps'] > 0, df['apps'] - 1, df['apps'])\n    \n    result = df.set_index(['user'])", "title": "Top 15 active users", "nodeClass": "report", "moduleId": "logs_overview", "x": 250, "y": 310, "z": 1, "w": "180", "h": "40", "description": "", "units": "", "color": "#d5a6bd", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": {"component_type": "core.Table", "component_id": "aba7eb58-692f-4757-bb25-e1fec5d68965", "namespace": "ppc", "node_id": "logs_top_15_active_users", "x": 0, "y": 0, "w": 6, "h": 3, "error_code": null, "error_detail": null, "properties": {"code": null, "custom_code": false, "title": {"enabled": true, "text": "Top 15 active users", "custom_text": "", "show_units": true, "units_text": ""}, "hide_header": null, "hide_border": null, "table_properties": {"colHeaders": true, "manualColumnResize": true, "multiColumnSorting": true, "rowHeaders": false}, "calculated_fields": [], "unlink": [], "pivot": {"agg": {"calls": "sum"}, "params": {"rows": [], "columns": [], "measures": []}}, "page_size": {"rows": 100, "columns": 500}, "sort": {}, "renderers": {}, "columns": {}, "right_total": false, "bottom_total": false, "hide_empty_data": "", "show_pivot_toolbar": false, "show_filter_toolbar": false, "drilldowns": [], "styles": {"all": {"style": {}, "conditional_format": [], "value_format": {"type": "number", "thousands_separator": true, "decimal_places": 2, "prefix": "", "suffix": "", "date_format": ""}}, "custom": []}, "applied_hierarchies": {}}, "alternative_properties": null, "filters": {}, "cell_properties": null}, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}, {"identifier": "a5bb215354d044e50903431e11227023a", "definition": "", "title": "Overview", "nodeClass": "text", "moduleId": "logs_overview", "x": 20, "y": 50, "z": -1, "w": "640", "h": "320", "description": "Logs overview", "units": null, "color": "#EEEEEE", "errorInDef": false, "nodeInfo": {"showInputs": 0, "showOutputs": 0, "showLabel": 1, "showBorder": 0, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": null, "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": null, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": null}, {"identifier": "a5c234324e60e4fe8a978956b28f398db", "definition": "result = logs_of_current_company", "title": "Logs of current company", "nodeClass": "alias", "moduleId": "logs_overview", "x": 40, "y": 130, "z": 1, "w": "180", "h": "40", "description": "", "units": null, "color": "#4CBCFF", "errorInDef": false, "nodeInfo": {"showInputs": 1, "showOutputs": 1, "showLabel": 1, "showBorder": 1, "fill": 1, "useNodeFont": 0}, "nodeFont": null, "numberFormat": null, "originalId": "logs_of_current_company", "extraData": null, "picture": null, "evaluateOnStart": false, "defaultView": {"component_type": "core.Table", "component_id": "19fbdabf-3248-49b0-a8dd-3c5ff3574ba2", "namespace": "ppc", "node_id": "logs_of_current_company", "x": 0, "y": 0, "w": 6, "h": 3, "error_code": null, "error_detail": null, "properties": {"code": null, "custom_code": false, "title": {"enabled": true, "text": "Logs of current company", "custom_text": "", "show_units": true, "units_text": ""}, "hide_header": null, "hide_border": null, "table_properties": {"colHeaders": true, "manualColumnResize": true, "multiColumnSorting": true, "rowHeaders": false}, "calculated_fields": [], "unlink": [], "pivot": {"agg": {"calls": "sum"}, "params": {"rows": [], "columns": [], "measures": []}}, "page_size": {"rows": 100, "columns": 500}, "sort": {}, "renderers": {}, "columns": {}, "right_total": false, "bottom_total": false, "hide_empty_data": "", "show_pivot_toolbar": false, "show_filter_toolbar": false, "drilldowns": [], "styles": {"all": {"style": {}, "conditional_format": [], "value_format": {"type": "number", "thousands_separator": true, "decimal_places": 2, "prefix": "", "suffix": "", "date_format": ""}}, "custom": []}, "applied_hierarchies": {}}, "alternative_properties": null, "filters": {}, "cell_properties": null}, "prefixIdentifier": null, "hierarchy": null, "_isNodeCircular": false}]}